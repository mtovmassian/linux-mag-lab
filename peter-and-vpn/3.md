# Capabilities

1. Add the capabilities to the executable:
```shell
sudo setcap cap_net_admin=ep ./tun-do
```
- The characters *"e"* and *"p"* each specify a *capability set* in which CAP_NET_ADMIN is to be added: *"effective"* and *"permitted"*. What we want the program having authorization at execution time, which corresponds to *capability set effective*. But everything that is in *effective* must also be allowed, so be also in *permitted*.
2. At the end of the program, once the network interface initialization is done we no longer need special rights. No need to keep the *capabilities* when we delegate to the second program at the time of the `execvp()`. Thanks to nominal operation of `execvp()` the two capability sets are automatically remove from `CAP_NET_ADMIN` at this moment.